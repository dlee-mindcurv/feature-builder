{
  "project": "taskflow",
  "branchName": "feature/auth-login",
  "description": "Implement user authentication flow using NextAuth with credentials provider, login page, persistent header with auth controls and theme toggle, and route protection for the TaskFlow application.",
  "userStories": [
    {
      "id": "US-001",
      "title": "NextAuth Configuration with Credentials Provider",
      "description": "As a developer, I want NextAuth configured with a credentials provider and mock user data so that the application has a working authentication backend.",
      "acceptanceCriteria": [
        "Install next-auth and configure with App Router API route at app/api/auth/[...nextauth]/route.ts",
        "Configure a credentials provider that validates against mock user data (test user: user@taskflow.com / password123)",
        "Use JWT session strategy (no database required)",
        "Wrap the application with NextAuth SessionProvider in the root layout alongside existing ThemeProvider and TaskProvider",
        "Create .env.example documenting NEXTAUTH_SECRET and NEXTAUTH_URL variables",
        "Create .env.local with a generated NEXTAUTH_SECRET value and NEXTAUTH_URL=http://localhost:3000",
      ],
      "priority": 1,
      "model": "sonnet",
      "passes": false,
      "notes": "",
      "jobs": [
        {"name": "build", "agent": "build-user-story", "status": "pending", "dependsOn": null, "notes": ""},
      ]
    },
    {
      "id": "US-002",
      "title": "Login Page",
      "description": "As a user, I want a login page where I can enter my email and password so that I can authenticate and access my tasks.",
      "acceptanceCriteria": [
        "A login page exists at the /login route (src/app/login/page.tsx)",
        "The page displays the existing TaskFlow Logo component and a 'Sign in to TaskFlow' heading",
        "The form contains email and password input fields with appropriate labels, reusing the existing Input component from src/components/ui/",
        "A 'Sign In' submit button is present using the existing Button component from src/components/ui/",
        "Form validation prevents submission when email or password fields are empty",
        "On successful login via NextAuth signIn(), the user is redirected to the home page (/)",
        "On failed login, an inline error message 'Invalid email or password' is displayed without clearing the form",
        "The submit button shows a loading/disabled state while authentication is in progress",
        "The login page is centered vertically and horizontally with a card-style form container",
        "The page is responsive and usable on both desktop and mobile viewports",
        "Supports dark mode via existing ThemeContext",
      ],
      "priority": 2,
      "model": "sonnet",
      "passes": false,
      "notes": "",
      "jobs": [
        {"name": "build", "agent": "build-user-story", "status": "pending", "dependsOn": null, "notes": ""},
      ]
    },
    {
      "id": "US-003",
      "title": "Header with Auth Controls, Theme Toggle, and Route Protection",
      "description": "As a user, I want a header bar on all pages showing my login status with logout capability, a theme toggle, and route protection so that I can manage my session and keep my data private.",
      "acceptanceCriteria": [
        "A Header component exists at src/components/ui/Header.tsx rendered at the top of every page via the root layout",
        "The header displays the TaskFlow Logo component on the left side",
        "When authenticated, the header shows the user's email address and a 'Sign Out' button",
        "Clicking 'Sign Out' calls NextAuth signOut() and redirects to /login",
        "When not authenticated, the header shows a 'Sign In' link that navigates to /login",
        "The header includes a theme toggle button with sun/moon icons that switches between light and dark mode using the existing ThemeContext",
        "Theme preference persists across page reloads via localStorage",
        "The header is responsive with auth controls accessible on mobile",
        "The header uses Tailwind CSS consistent with existing TaskFlow design and supports dark mode",
        "Replace the existing inline header markup in the home page with the new Header component",
        "Add middleware.ts at the project root that redirects unauthenticated users from protected routes to /login",
        "The login page (/login) is accessible to unauthenticated users without redirect loops",
        "Authenticated users visiting /login are redirected to /",
        "Write unit tests for the Header component",
      ],
      "priority": 3,
      "model": "sonnet",
      "passes": false,
      "notes": "",
      "jobs": [
        {"name": "build", "agent": "build-user-story", "status": "pending", "dependsOn": null, "notes": ""},
      ]
    }
  ]
}
